<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0d1525" />
  <title>Como Funcionam Redes de Computadores</title>

  <!-- Fontes premium -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Ícones premium -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* ---------- PALETA AZUL PREMIUM (PADRÃO) - CORES MAIS SUAVES ---------- */
    :root {
      --bg-900: #071428;
      --bg-gradient: linear-gradient(160deg, #0a0e17 0%, #0d1525 35%, #121c33 70%, #1a2540 100%);
      --card-bg: rgba(18, 28, 51, 0.7);
      --card-border: rgba(143, 233, 255, 0.15);
      --accent: #00a8ff;
      --accent-light: #8fe9ff;
      --text-primary: #ffffff;
      --text-secondary: #b8d7ea;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(0, 168, 255, 0.08);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(0, 168, 255, 0.35);
      --transition: all 0.28s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --warp-bg: radial-gradient(circle, rgba(0, 168, 255, 0.25) 0%, rgba(0, 168, 255, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#00a8ff,#8fe9ff,#b8d7ea';
    }

    /* Tema Vermelho Suavizado */
    :root.theme-red {
      --bg-900: #1a0d0d;
      --bg-gradient: linear-gradient(160deg, #1a0d0d 0%, #2c1818 35%, #3d2222 70%, #501616 100%);
      --card-bg: rgba(26, 13, 13, 0.75);
      --card-border: rgba(244, 143, 143, 0.12);
      --accent: #ef9a9a;
      --accent-light: #ffcdd2;
      --text-primary: #fff8f8;
      --text-secondary: #f8bbd9;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(239, 154, 154, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(239, 154, 154, 0.25);
      --warp-bg: radial-gradient(circle, rgba(239, 154, 154, 0.25) 0%, rgba(239, 154, 154, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#ef9a9a,#ffcdd2,#fff8f8';
    }

    /* Tema Verde Suavizado */
    :root.theme-green {
      --bg-900: #0f1a0f;
      --bg-gradient: linear-gradient(160deg, #0f1a0f 0%, #1a281a 35%, #254a25 70%, #306d30 100%);
      --card-bg: rgba(15, 26, 15, 0.75);
      --card-border: rgba(144, 238, 144, 0.12);
      --accent: #a5d6a7;
      --accent-light: #e8f5e8;
      --text-primary: #f1f8e9;
      --text-secondary: #c8e6c9;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(165, 214, 167, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(165, 214, 167, 0.25);
      --warp-bg: radial-gradient(circle, rgba(165, 214, 167, 0.25) 0%, rgba(165, 214, 167, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#a5d6a7,#e8f5e8,#f1f8e9';
    }

    /* Tema Roxo Suavizado */
    :root.theme-purple {
      --bg-900: #1a0f1f;
      --bg-gradient: linear-gradient(160deg, #1a0f1f 0%, #2a1a2f 35%, #3d2744 70%, #501659 100%);
      --card-bg: rgba(26, 15, 31, 0.75);
      --card-border: rgba(221, 160, 221, 0.12);
      --accent: #ce93d8;
      --accent-light: #f3e5f5;
      --text-primary: #fafafa;
      --text-secondary: #e1bee7;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(206, 147, 216, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(206, 147, 216, 0.25);
      --warp-bg: radial-gradient(circle, rgba(206, 147, 216, 0.25) 0%, rgba(206, 147, 216, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#ce93d8,#f3e5f5,#fafafa';
    }

    /* Tema Laranja Suavizado */
    :root.theme-orange {
      --bg-900: #2c1608;
      --bg-gradient: linear-gradient(160deg, #2c1608 0%, #3d1f0e 35%, #582919 70%, #723424 100%);
      --card-bg: rgba(44, 22, 8, 0.75);
      --card-border: rgba(255, 218, 185, 0.12);
      --accent: #ffb74d;
      --accent-light: #fff8e1;
      --text-primary: #fffde7;
      --text-secondary: #ffe0b2;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(255, 183, 77, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(255, 183, 77, 0.25);
      --warp-bg: radial-gradient(circle, rgba(255, 183, 77, 0.25) 0%, rgba(255, 183, 77, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#ffb74d,#fff8e1,#fffde7';
    }

    /* Tema Rosa Suavizado */
    :root.theme-pink {
      --bg-900: #1f0a1a;
      --bg-gradient: linear-gradient(160deg, #1f0a1a 0%, #2f0f25 35%, #42153a 70%, #541b4f 100%);
      --card-bg: rgba(31, 10, 26, 0.75);
      --card-border: rgba(255, 182, 193, 0.12);
      --accent: #f8bbd9;
      --accent-light: #fce4ec;
      --text-primary: #fdf2f8;
      --text-secondary: #f8bbd9;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(248, 187, 217, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(248, 187, 217, 0.25);
      --warp-bg: radial-gradient(circle, rgba(248, 187, 217, 0.25) 0%, rgba(248, 187, 217, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#f8bbd9,#fce4ec,#fdf2f8';
    }

    /* Tema Ciano Suavizado */
    :root.theme-teal {
      --bg-900: #0a1f1f;
      --bg-gradient: linear-gradient(160deg, #0a1f1f 0%, #0f2a2a 35%, #144040 70%, #195555 100%);
      --card-bg: rgba(10, 31, 31, 0.75);
      --card-border: rgba(175, 238, 238, 0.12);
      --accent: #80deea;
      --accent-light: #e0f2f1;
      --text-primary: #f0f9ff;
      --text-secondary: #b2dfdb;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(128, 222, 234, 0.06);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(128, 222, 234, 0.25);
      --warp-bg: radial-gradient(circle, rgba(128, 222, 234, 0.25) 0%, rgba(128, 222, 234, 0.12) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#80deea,#e0f2f1,#f0f9ff';
    }

    /* Tema Preto e Branco (Cinza Escala) Suavizado */
    :root.theme-grayscale {
      --bg-900: #000000;
      --bg-gradient: linear-gradient(160deg, #000000 0%, #111111 35%, #222222 70%, #333333 100%);
      --card-bg: rgba(0, 0, 0, 0.75);
      --card-border: rgba(211, 211, 211, 0.06);
      --accent: #e0e0e0;
      --accent-light: #f5f5f5;
      --text-primary: #ffffff;
      --text-secondary: #d3d3d3;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --timeline-bg: rgba(224, 224, 224, 0.03);
      --timeline-progress: linear-gradient(90deg, var(--accent-light), var(--accent));
      --glow: 0 0 20px rgba(224, 224, 224, 0.15);
      --warp-bg: radial-gradient(circle, rgba(224, 224, 224, 0.15) 0%, rgba(224, 224, 224, 0.08) 30%, rgba(0, 0, 0, 0.92) 70%);
      --warp-conic: conic-gradient(from 0deg, transparent, var(--accent-light), transparent);
      --confetti-colors: '#e0e0e0,#f5f5f5,#d3d3d3';
    }

    /* Reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      :root { --transition: none; }
      * { transition: none !important; animation: none !important; }
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body { height: 100%; margin: 0; background: var(--bg-gradient); color: var(--text-secondary); font-family: 'Space Grotesk', 'Montserrat', system-ui, -apple-system, 'Segoe UI', Roboto, Arial; overflow-x: hidden; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; transition: var(--transition); }

    /* Container central */
    .container { width: 100%; max-width: 1400px; margin: 0 auto; padding: 18px; min-height: 100vh; display: flex; flex-direction: column; }

    header { display: flex; align-items: center; gap: 16px; padding: 12px 0; position: relative; z-index: 10; flex-wrap: wrap; justify-content: center; }

    .logo { width: 70px; height: 70px; border-radius: 16px; background: linear-gradient(135deg, var(--text-primary), var(--accent)); display: grid; place-items: center; color: var(--bg-900); font-weight: 800; font-size: 20px; box-shadow: var(--glow); transition: var(--transition); flex-shrink: 0; }
    .logo:hover { transform: scale(1.04); }

    .header-content { flex: 1; min-width: 0; text-align: center; }
    h1 { margin: 0; color: var(--text-primary); font-size: 22px; font-weight: 800; letter-spacing: -0.4px; background: linear-gradient(to right, var(--text-primary), var(--accent-light)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    .subtitle { margin-top: 6px; color: var(--text-secondary); font-size: 13px; line-height: 1.4; max-width: 64ch; }

    .controls { display: flex; gap: 10px; align-items: center; margin-left: auto; flex-wrap: wrap; justify-content: flex-end; }

    .btn { background: linear-gradient(90deg, var(--accent-light), var(--accent)); color: var(--bg-900); border: 0; padding: 9px 14px; border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 13px; display: inline-flex; align-items: center; gap: 8px; box-shadow: var(--glow); transition: var(--transition); white-space: nowrap; }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 28px rgba(0,168,255,0.28); }

    .ghost { background: transparent; border: 1px solid var(--card-border); color: var(--text-primary); padding: 8px 12px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: var(--transition); white-space: nowrap; }
    .ghost:hover { background: rgba(143, 233, 255, 0.06); transform: translateY(-1px); }

    /* Main layout */
    .main-content { display: flex; flex-direction: column; gap: 20px; margin-top: 18px; }
    @media (min-width: 992px) { .main-content { flex-direction: row; } }

    .content-section, .quiz-section { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 18px; padding: 20px; box-shadow: 0 6px 24px rgba(0, 10, 20, 0.5); backdrop-filter: blur(8px); position: relative; overflow: hidden; width: 100%; }

    /* Tabs */
    .tabs { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
    .tab { padding: 9px 14px; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 13px; background: transparent; color: var(--text-secondary); border: 1px solid var(--card-border); transition: var(--transition); }
    .tab:hover { background: rgba(143, 233, 255, 0.06); color: var(--text-primary); }
    .tab.active { background: linear-gradient(90deg, var(--accent-light), var(--accent)); color: var(--bg-900); border-color: var(--accent); }

    .tabpanel { display: none; }
    .tabpanel.active { display: block; }
    .tabpanel h3 { color: var(--text-primary); font-size: 16px; font-weight: 700; margin-bottom: 10px; }
    .tabpanel p, .tabpanel li { line-height: 1.5; font-size: 14px; color: var(--text-secondary); }

    /* Concepts */
    .concepts-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 10px; }
    .concepts-title { color: var(--text-primary); font-size: 18px; font-weight: 700; }
    .concepts-list { display: grid; gap: 8px; }
    .concept-item { padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px; border-left: 3px solid var(--accent); }

    /* Quiz like first */
    .quiz-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 10px; }
    .quiz-title { color: var(--text-primary); font-size: 18px; font-weight: 700; }
    .progress-container { height: 8px; background: rgba(255,255,255,0.06); border-radius: 6px; margin: 12px 0; overflow: hidden; }
    .progress-bar { height: 100%; background: var(--timeline-progress); border-radius: 6px; width: 0%; transition: width 0.45s ease; }

    .question-container { margin: 10px 0; }
    .question-number { color: var(--accent); font-weight: 700; margin-bottom: 6px; }
    .question-text { color: var(--text-primary); font-size: 15px; margin-bottom: 12px; line-height: 1.4; }

    .options-container { display: grid; gap: 10px; }
    .option { padding: 12px 14px; border-radius: 10px; background: rgba(255,255,255,0.03); border: 1px solid var(--card-border); color: var(--text-secondary); font-weight: 600; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px; }
    .option:hover { background: rgba(143, 233, 255, 0.06); transform: translateX(4px); color: var(--text-primary); }
    .option.selected { background: rgba(0, 168, 255, 0.12); border-color: var(--accent); color: var(--text-primary); box-shadow: 0 0 10px rgba(0,168,255,0.12); }
    .option.correct { background: rgba(74, 222, 128, 0.12); border-color: var(--success); color: #d1fae5; }
    .option.wrong { background: rgba(248, 113, 113, 0.12); border-color: var(--error); color: #fee2e2; }

    .option-letter { display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 50%; background: rgba(255,255,255,0.06); font-weight: 800; font-size: 12px; }

    .quiz-controls { display: flex; justify-content: space-between; margin-top: 14px; flex-wrap: wrap; gap: 10px; }
    .nav-buttons { display: flex; gap: 8px; }
    .score-display { font-weight: 800; font-size: 15px; color: var(--accent); display: flex; align-items: center; gap: 8px; }

    footer { margin-top: 22px; padding: 14px; text-align: center; color: var(--text-secondary); font-size: 12px; border-top: 1px solid var(--card-border); }

    /* Responsive tweaks */
    @media (max-width: 768px) {
      .logo { width: 60px; height: 60px; font-size: 18px; }
      h1 { font-size: 20px; }
      .subtitle { font-size: 13px; }
      .quiz-controls { width: 100%; flex-direction: column; align-items: center; }
      .nav-buttons, .score-display { width: 100%; justify-content: center; }
      .tabs { justify-content: center; }
      .btn, .ghost { width: auto; padding: 8px 12px; font-size: 12px; }
    }
    @media (max-width: 480px) {
      .container { padding: 12px; }
      .logo { width: 50px; height: 50px; font-size: 16px; }
      h1 { font-size: 18px; }
      .subtitle { font-size: 12px; }
      .btn, .ghost { padding: 6px 10px; font-size: 11px; }
    }

  </style>
</head>
<body>
  <div class="container">
    <header role="banner">
      <div class="logo" aria-hidden="true">C→Net</div>

      <div class="header-content">
        <h1>Como Funcionam Redes de Computadores</h1>
        <p class="subtitle">Explore conceitos fundamentais e teste seu conhecimento com interações práticas.</p>
      </div>
    </header>

    <main class="main-content" role="main">
      <section class="content-section" aria-labelledby="content-title">
        <h2 class="sim-title" id="content-title">Conceitos Fundamentais</h2>

        <div class="tabs" role="tablist">
          <button class="tab active" data-tab="pacotes">Pacotes de Dados</button>
          <button class="tab" data-tab="enderecos">Endereços IP e MAC</button>
          <button class="tab" data-tab="dispositivos">Dispositivos de Rede</button>
          <button class="tab" data-tab="protocolos">Protocolos</button>
        </div>

        <div id="pacotes" class="tabpanel active">
          <h3>Pacotes de Dados</h3>
          <p>Em uma rede, os dados não são enviados como um fluxo contínuo, mas divididos em unidades menores chamadas pacotes. Isso permite transmissão eficiente, recuperação de erros e roteamento flexível. Cada pacote contém cabeçalhos com informações como origem, destino e sequência, sendo reensamblados no receptor. Essa abordagem é fundamental no modelo TCP/IP.</p>
          <ul>
            <li><strong>Vantagens:</strong> Reduz congestionamento e facilita o diagnóstico de falhas.</li>
            <li><strong>Exemplo:</strong> Ao carregar uma página web, o conteúdo é fracionado em pacotes que viajam por rotas possivelmente diferentes.</li>
          </ul>
        </div>

        <div id="enderecos" class="tabpanel">
          <h3>Endereços IP e MAC</h3>
          <p>O endereço IP é um identificador lógico único para dispositivos em uma rede, como 192.168.1.5 (IPv4) ou mais longo em IPv6. Já o MAC é um endereço físico gravado no hardware da placa de rede, usado para comunicação local. O IP permite roteamento global, enquanto o MAC gerencia entregas dentro de uma LAN.</p>
          <ul>
            <li><strong>IP:</strong> Mudável, gerenciado por DHCP ou configuração manual.</li>
            <li><strong>MAC:</strong> Fixo, formato como 00:1A:2B:3C:4D:5E.</li>
            <li><strong>ARP:</strong> Protocolo que mapeia IP para MAC.</li>
          </ul>
        </div>

        <div id="dispositivos" class="tabpanel">
          <h3>Dispositivos de Rede</h3>
          <p>Dispositivos como switches e roteadores são essenciais. O switch conecta múltiplos dispositivos em uma rede local (LAN), encaminhando frames com base em endereços MAC para evitar colisões. O roteador, por outro lado, interliga redes diferentes (ex: LAN para WAN/internet), usando tabelas de roteamento para direcionar pacotes por IP.</p>
          <ul>
            <li><strong>Switch:</strong> Opera na camada 2 (enlace), ideal para tráfego interno.</li>
            <li><strong>Roteador:</strong> Opera na camada 3 (rede), suporta NAT e firewall.</li>
            <li><strong>Outros:</strong> Hubs (simples, mas obsoletos) e access points para Wi-Fi.</li>
          </ul>
        </div>

        <div id="protocolos" class="tabpanel">
          <h3>Protocolos de Comunicação</h3>
          <p>Protocolos definem regras padronizadas para troca de dados, garantindo compatibilidade entre dispositivos heterogêneos. No modelo TCP/IP, camadas como aplicação (HTTP), transporte (TCP/UDP), rede (IP) e enlace (Ethernet) trabalham em conjunto. Sem protocolos, a comunicação seria caótica e ineficiente.</p>
          <ul>
            <li><strong>TCP:</strong> Confiável, com controle de fluxo e retransmissão.</li>
            <li><strong>UDP:</strong> Rápido, sem garantias, usado em streaming.</li>
            <li><strong>Benefícios:</strong> Interoperabilidade global e escalabilidade.</li>
          </ul>
        </div>

        <div class="concepts-section">
          <div class="concepts-header">
            <h3 class="concepts-title">Conceitos rápidos</h3>
          </div>
          <ul class="concepts-list">
            <li class="concept-item"><strong>Pacotes:</strong> Unidades de dados divididas para transmissão eficiente.</li>
            <li class="concept-item"><strong>IP:</strong> endereço lógico (ex: 192.168.1.5).</li>
            <li class="concept-item"><strong>MAC:</strong> endereço de hardware do adaptador de rede.</li>
            <li class="concept-item"><strong>Switch:</strong> conecta dispositivos numa mesma rede local.</li>
            <li class="concept-item"><strong>Roteador:</strong> conecta redes diferentes e encaminha pacotes.</li>
            <li class="concept-item"><strong>Protocolos:</strong> regras que garantem comunicação padronizada (ex: TCP/IP).</li>
          </ul>
        </div>
      </section>

      <aside class="quiz-section" aria-labelledby="quiz-title">
        <div class="quiz-header">
          <h2 class="quiz-title" id="quiz-title">Quiz Interativo</h2>
          <div class="score-display" id="score-display"><i class="fas fa-graduation-cap" aria-hidden="true"></i> <span id="score">0/10</span></div>
        </div>

        <div class="progress-container" aria-hidden="false">
          <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="question-container" id="question-container"></div>

        <div class="quiz-controls">
          <div class="nav-buttons">
            <button id="prev" class="ghost" aria-label="Pergunta anterior"><i class="fas fa-arrow-left" aria-hidden="true"></i></button>
            <button id="next" class="btn" aria-label="Próxima pergunta"><i class="fas fa-arrow-right" aria-hidden="true"></i></button>
          </div>
          <button id="submit" class="btn" aria-label="Enviar respostas"><i class="fas fa-paper-plane" aria-hidden="true"></i> Enviar</button>
        </div>
      </aside>
    </main>

    <footer role="contentinfo">
      <p>Resumo: Redes conectam via hardware e protocolos em camadas TCP/IP. Quiz testa conceitos chave como IP, roteamento e switches.</p>
      <p>Atalhos: ← / → — Navegar perguntas. Enter — Selecionar opção.</p>
      <p>Dica: Explore os conceitos antes do quiz!</p>
    </footer>
  </div>

  <canvas id="confetti" style="position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:1200"></canvas>

  <script>
    // ---------- Detecção e Aplicação de Tema ----------
    function applyTheme(theme) {
      const root = document.documentElement;
      root.className = theme === 'blue' ? '' : `theme-${theme}`;
      localStorage.setItem('theme', theme);
      // Atualiza confetti para tema
      const canvas = document.getElementById('confetti');
      if (canvas) {
        const accent = getComputedStyle(root).getPropertyValue('--accent').trim();
        // Não precisa atualizar grid aqui, pois não há warp
      }
    }
    function hexToRgb(hex, alpha = 1) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return `${r}, ${g}, ${b}${alpha !== 1 ? `, ${alpha}` : ''}`;
    }
    // Carrega tema salvo
    const savedTheme = localStorage.getItem('theme') || 'blue';
    applyTheme(savedTheme);
    // Listener para mudanças de tema (se alterado em outra aba)
    window.addEventListener('storage', (e) => {
      if (e.key === 'theme') applyTheme(e.newValue);
    });

    const quiz = [
      { q: 'Qual é a principal forma como os dados viajam em uma rede moderna?', opts: ['Como um fluxo ininterrupto', 'Divididos em unidades menores com cabeçalhos', 'Apenas em cabos físicos sem divisão'], a: 1, explain: 'A divisão em pacotes permite rotas flexíveis e recuperação de erros, essencial no modelo TCP/IP.' },
      { q: 'O que os pacotes incluem para garantir a reordenação no destino?', opts: ['Apenas o conteúdo principal', 'Informações de origem, destino e sequência', 'Códigos de cor para identificação'], a: 1, explain: 'Cabeçalhos com detalhes como sequência ajudam na reensamblagem correta dos dados.' },
      { q: 'Por que dividir dados em pacotes reduz problemas em redes?', opts: ['Aumenta o tamanho total', 'Facilita o roteamento e o diagnóstico de falhas', 'Exige mais energia'], a: 1, explain: 'Isso minimiza congestionamentos e permite rotas alternativas para cada unidade.' },
      { q: 'Qual tipo de endereço é usado para identificar dispositivos logicamente em uma rede global?', opts: ['Endereço físico gravado no hardware', 'Identificador como 192.168.1.5 que pode mudar', 'Nome do fabricante do dispositivo'], a: 1, explain: 'O IP é lógico e gerenciado por DHCP, permitindo roteamento entre redes diferentes.' },
      { q: 'Como o endereço MAC difere do IP em termos de uso?', opts: ['É mudável e global', 'É fixo e para comunicação local em LANs', 'Não é usado em redes cabeadas'], a: 1, explain: 'MAC gerencia entregas dentro de uma rede local, enquanto IP cuida do roteamento amplo.' },
      { q: 'Qual protocolo auxilia na associação entre endereços IP e MAC?', opts: ['HTTP para páginas web', 'ARP para mapeamento em redes locais', 'UDP para streaming rápido'], a: 1, explain: 'ARP resolve IPs em MACs para entregas precisas na camada de enlace.' },
      { q: 'Em qual camada do modelo OSI um switch tipicamente opera?', opts: ['Camada 3 para roteamento global', 'Camada 2 para tráfego interno por MAC', 'Camada 7 para aplicativos'], a: 1, explain: 'Switches encaminham frames baseados em MAC na camada de enlace, ideal para LANs.' },
      { q: 'Qual recurso um roteador usa para direcionar pacotes entre redes distintas?', opts: ['Tabelas baseadas em endereços MAC locais', 'Tabelas de roteamento por IP com suporte a NAT', 'Conexões diretas sem tabelas'], a: 1, explain: 'Roteadores operam na camada de rede, interligando LANs e WANs com eficiência.' },
      { q: 'Por que protocolos como TCP são descritos como confiáveis?', opts: ['Não verificam erros', 'Incluem controle de fluxo e retransmissão', 'São mais lentos sem motivo'], a: 1, explain: 'TCP garante entrega ordenada com mecanismos de correção, ao contrário de UDP.' },
      { q: 'Qual camada do TCP/IP lida com regras para troca de dados entre camadas como aplicação e transporte?', opts: ['Enlace para hardware local', 'Rede para endereçamento IP', 'Transporte para TCP/UDP e fluxo'], a: 2, explain: 'A camada de transporte gerencia conexões confiáveis ou rápidas, integrando com outras camadas.' }
    ];

    const QUIZ_KEY = 'quiz_submitted_at';
    let currentQuestion = 0;
    let answers = JSON.parse(localStorage.getItem('quiz_answers')) || new Array(quiz.length).fill(null);
    let quizSubmitted = localStorage.getItem(QUIZ_KEY) !== null;

    // --- DOM ---
    const questionContainer = document.getElementById('question-container');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const submitBtn = document.getElementById('submit');
    const scoreSpan = document.getElementById('score');
    const progressBar = document.getElementById('progress-bar');

    // --- Inicialização ---
    document.addEventListener('DOMContentLoaded', () => {
      setupTabs();
      if (quizSubmitted && !canRetake()) {
        submitBtn.click();
      } else {
        renderQuestion();
        updateProgress();
      }
      setupEventListeners();
      updateRetakeButton();
    });

    // Tabs
    function setupTabs() {
      showTab('pacotes');
    }

    function showTab(tabId) {
      // Hide all
      document.querySelectorAll('.tabpanel').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      // Show selected
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => showTab(tab.dataset.tab));
    });

    function canRetake() {
      const submittedAt = localStorage.getItem(QUIZ_KEY);
      if (!submittedAt) return true;
      const now = Date.now();
      const diffMinutes = (now - parseInt(submittedAt)) / (1000 * 60);
      return diffMinutes >= 10;
    }

    function updateRetakeButton() {
      const existing = document.getElementById('retake-btn');
      if (existing) existing.remove();

      if (quizSubmitted && !canRetake()) {
        const retakeBtn = document.createElement('button');
        retakeBtn.id = 'retake-btn';
        retakeBtn.className = 'btn';
        retakeBtn.disabled = true;
        retakeBtn.innerHTML = '<i class="fas fa-clock" aria-hidden="true"></i> Aguarde...';
        document.querySelector('.quiz-controls').appendChild(retakeBtn);

        const countdown = setInterval(() => {
          const submittedAt = localStorage.getItem(QUIZ_KEY);
          const now = Date.now();
          const remaining = 10 - Math.floor((now - parseInt(submittedAt)) / (1000 * 60));
          if (remaining <= 0) {
            clearInterval(countdown);
            updateRetakeButton();
          } else {
            retakeBtn.innerHTML = `<i class="fas fa-clock" aria-hidden="true"></i> Refazer em ${remaining} min`;
          }
        }, 1000);
      } else if (quizSubmitted && canRetake()) {
        const retakeBtn = document.createElement('button');
        retakeBtn.id = 'retake-btn';
        retakeBtn.className = 'btn';
        retakeBtn.innerHTML = '<i class="fas fa-redo" aria-hidden="true"></i> Refazer Quiz';
        retakeBtn.addEventListener('click', resetQuiz);
        document.querySelector('.quiz-controls').appendChild(retakeBtn);
      }
    }

    function resetQuiz() {
      localStorage.removeItem('quiz_answers');
      localStorage.removeItem(QUIZ_KEY);
      answers = new Array(quiz.length).fill(null);
      currentQuestion = 0;
      quizSubmitted = false;
      renderQuestion();
      updateProgress();
      updateRetakeButton();

      const scoreDisplay = document.getElementById('score-display');
      scoreDisplay.innerHTML = `<i class="fas fa-graduation-cap" aria-hidden="true"></i> <span id="score">0/10</span>`;
      document.getElementById('score').textContent = '0/10';
    }

    // Quiz like first
    function renderQuestion() {
      if (quizSubmitted && !canRetake()) return;

      const q = quiz[currentQuestion];
      questionContainer.innerHTML = `
        <div class="question-number">Pergunta ${currentQuestion + 1} de ${quiz.length}</div>
        <div class="question-text">${q.q}</div>
        <div class="options-container" id="options-container"></div>
      `;

      const optionsContainer = document.getElementById('options-container');
      q.opts.forEach((opt, idx) => {
        const option = document.createElement('div');
        option.className = 'option';
        option.setAttribute('role','button');
        option.setAttribute('tabindex','0');
        option.setAttribute('aria-pressed', String(answers[currentQuestion] === idx));
        if (answers[currentQuestion] === idx) option.classList.add('selected');
        option.innerHTML = `<div class="option-letter">${String.fromCharCode(65 + idx)}</div><div>${opt}</div>`;
        option.dataset.index = idx;
        optionsContainer.appendChild(option);
      });

      prevBtn.disabled = currentQuestion === 0;
      nextBtn.disabled = currentQuestion === quiz.length - 1;

      const answered = answers.filter(a => a !== null).length;
      scoreSpan.textContent = `${answered}/${quiz.length}`;
    }

    function updateProgress() {
      const answered = answers.filter(a => a !== null).length;
      const percentage = (answered / quiz.length) * 100;
      progressBar.style.width = `${percentage}%`;
    }

    // Listeners
    function setupEventListeners() {
      // Quiz options
      document.addEventListener('click', (e) => {
        if (quizSubmitted && !canRetake()) return;
        const option = e.target.closest('.option');
        if (!option) return;
        const idx = parseInt(option.dataset.index, 10);
        answers[currentQuestion] = idx;
        localStorage.setItem('quiz_answers', JSON.stringify(answers));
        renderQuestion();
        updateProgress();
      });

      document.addEventListener('keydown', (e) => {
        if (quizSubmitted && !canRetake()) return;
        const option = e.target.closest('.option');
        if (!option) return;
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); option.click(); }
      });

      prevBtn.addEventListener('click', () => {
        if (quizSubmitted && !canRetake()) return;
        if (currentQuestion > 0) {
          currentQuestion--;
          renderQuestion();
        }
      });
      nextBtn.addEventListener('click', () => {
        if (quizSubmitted && !canRetake()) return;
        if (currentQuestion < quiz.length - 1) {
          currentQuestion++;
          renderQuestion();
        }
      });

      submitBtn.addEventListener('click', () => {
        if (quizSubmitted && !canRetake()) return;
        if (answers.some(a => a === null)) {
          alert('Por favor, responda todas as perguntas antes de enviar.');
          return;
        }

        localStorage.setItem(QUIZ_KEY, Date.now().toString());
        quizSubmitted = true;

        let correct = 0;
        for (let i = 0; i < quiz.length; i++) if (answers[i] === quiz[i].a) correct++;

        document.getElementById('score-display').innerHTML = `<i class="fas fa-trophy" aria-hidden="true"></i> ${correct}/${quiz.length}`;

        const reviewRoot = document.createElement('div');
        quiz.forEach((item, qIndex) => {
          const block = document.createElement('div');
          const h = document.createElement('div'); 
          h.style.fontWeight = '700'; 
          h.style.marginBottom = '12px'; 
          h.style.color = 'var(--text-primary)'; 
          h.textContent = `${qIndex+1}. ${item.q}`;
          block.appendChild(h);
          const opts = document.createElement('div');
          opts.style.display = 'grid';
          opts.style.gap = '8px';
          opts.style.marginBottom = '12px';
          item.opts.forEach((op, optIndex) => {
            const o = document.createElement('div'); 
            o.className = 'option'; 
            o.style.cursor = 'default'; 
            o.style.pointerEvents = 'none';
            o.innerHTML = `<div class="option-letter">${String.fromCharCode(65 + optIndex)}</div><div>${op}</div>`;
            if (optIndex === item.a) o.classList.add('correct');
            else if (answers[qIndex] === optIndex) o.classList.add('wrong');
            opts.appendChild(o);
          });
          block.appendChild(opts);
          const explain = document.createElement('div'); 
          explain.style.fontSize = '14px'; 
          explain.style.color = 'var(--success)'; 
          explain.style.fontStyle = 'italic'; 
          explain.style.marginTop = '8px';
          explain.textContent = item.explain;
          block.appendChild(explain);
          reviewRoot.appendChild(block);
        });

        questionContainer.innerHTML = '';
        questionContainer.appendChild(reviewRoot);

        updateRetakeButton();

        if (correct === quiz.length) {
          showSuccessToast();
          launchConfetti();
          playSound('success');
        } else {
          playSound('error');
        }
      });
    }

    // Efeitos sonoros (compatibilidade)
    function playSound(type) {
      const AudioCtx = window.AudioContext || window.webkitAudioContext;
      if (!AudioCtx) return; // se não suportado, silenciosamente ignora
      const audioCtx = new AudioCtx();
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.connect(gainNode); gainNode.connect(audioCtx.destination);
      switch(type) {
        case 'success': oscillator.type = 'sine'; oscillator.frequency.setValueAtTime(660, audioCtx.currentTime); oscillator.frequency.exponentialRampToValueAtTime(990, audioCtx.currentTime + 0.32); gainNode.gain.value = 0.15; gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.45); break;
        case 'error': oscillator.type = 'triangle'; oscillator.frequency.value = 260; gainNode.gain.value = 0.12; gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.28); break;
      }
      oscillator.start(); oscillator.stop(audioCtx.currentTime + (type === 'success' ? 0.45 : 0.22));
    }

    // Toast
    function showSuccessToast() {
      const toast = document.createElement('div');
      toast.style.position = 'fixed';
      toast.style.top = '16px';
      toast.style.left = '50%';
      toast.style.transform = 'translateX(-50%)';
      toast.style.padding = '12px 18px';
      toast.style.borderRadius = '12px';
      toast.style.background = 'linear-gradient(90deg, var(--success), #34d399)';
      toast.style.color = 'var(--bg-900)';
      toast.style.fontWeight = '800';
      toast.style.zIndex = 1000;
      toast.innerHTML = '<i class="fas fa-star" aria-hidden="true"></i> Parabéns! Você acertou todas as questões!';
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Confetti tema-aware
    const confettiCanvas = document.getElementById('confetti');
    const confettiCtx = confettiCanvas.getContext('2d');
    function resizeCanvas() { confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight; }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    let confettiPieces = [];
    function launchConfetti() {
      confettiPieces = [];
      // Pega cores do CSS (fallback para default)
      const root = document.documentElement;
      let colorsStr = getComputedStyle(root).getPropertyValue('--confetti-colors') || '#00a8ff,#8fe9ff,#b8d7ea';
      const colors = colorsStr.split(',').map(c => c.trim().replace(/['"]/g, ''));
      for (let i = 0; i < 120; i++) {
        confettiPieces.push({ 
          x: Math.random() * confettiCanvas.width, 
          y: -20, 
          r: 3 + Math.random() * 8, 
          vx: -3 + Math.random() * 6, 
          vy: 2 + Math.random() * 6, 
          rot: Math.random() * 360, 
          vr: -0.1 + Math.random() * 0.2, 
          color: colors[i % colors.length] 
        });
      }
      requestAnimationFrame(drawConfetti);
      setTimeout(() => { confettiPieces = []; confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); }, 3200);
    }
    function drawConfetti() {
      confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
      confettiPieces.forEach(p => {
        p.x += p.vx; p.y += p.vy; p.vy += 0.12; p.rot += p.vr;
        confettiCtx.save();
        confettiCtx.translate(p.x,p.y);
        confettiCtx.rotate((p.rot*Math.PI)/180);
        confettiCtx.fillStyle = p.color;
        confettiCtx.fillRect(-p.r/2,-p.r/2,p.r,p.r*0.6);
        confettiCtx.restore();
      });
      if (confettiPieces.length) requestAnimationFrame(drawConfetti);
    }

    window.addEventListener('keydown', e => {
      if (e.key === 'ArrowLeft') prevBtn.click();
      if (e.key === 'ArrowRight') nextBtn.click();
    });

    window.addEventListener('resize', () => {
      if (!quizSubmitted || canRetake()) {
        renderQuestion();
      }
    });
  </script>
</body>
</html>